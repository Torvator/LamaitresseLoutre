"use strict";(globalThis.webpackChunkcrpe_2026=globalThis.webpackChunkcrpe_2026||[]).push([[451],{515(e,r,i){i.d(r,{S:()=>s,b:()=>t});const t={HOME:"/LamaitresseLoutre/",LOGIN:"/LamaitresseLoutre/login",PROFIL:"/LamaitresseLoutre/profil",SUIVI:"/LamaitresseLoutre/suivi",COMMENTAIRES:"/LamaitresseLoutre/commentaires"};function s(e){window.location.href=e}},5653(e,r,i){i.d(r,{A:()=>d});var t=i(6540),s=i(5920),n=i(515),a=i(1656),o=i(4848);function d({children:e,title:r,description:i}){const{user:d,loading:l}=(0,s.A)();return(0,t.useEffect)(()=>{l||d||(0,n.S)(n.b.LOGIN)},[d,l]),l?(0,o.jsx)(a.A,{title:r,description:i,children:(0,o.jsx)("div",{style:{maxWidth:"600px",margin:"4rem auto",padding:"0 2rem",textAlign:"center"},children:(0,o.jsx)("p",{style:{fontSize:"1.2rem",color:"#4a4a4a"},children:"Chargement..."})})}):d?e:(0,o.jsx)(a.A,{title:r,description:i,children:(0,o.jsx)("div",{style:{maxWidth:"600px",margin:"4rem auto",padding:"0 2rem",textAlign:"center"},children:(0,o.jsx)("p",{style:{fontSize:"1.2rem",color:"#4a4a4a"},children:"Redirection vers la connexion..."})})})}},8837(e,r,i){i.r(r),i.d(r,{default:()=>g});var t=i(6540),s=i(1656),n=i(5653),a=i(5920),o=i(8185),d=i(5421),l=i(4848);function c({message:e,isAdmin:r,isOwnMessage:i}){const t=i?r?"#ff9a9e":"#6bcf7f":"#f5f5f5",s=i?"white":"#4a4a4a",n=i?"flex-end":"flex-start";let a="Envoi en cours...";if(e.date&&e.date.toDate)try{a=new Date(e.date.toDate()).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(o){a="Date invalide"}return(0,l.jsx)("div",{style:{display:"flex",justifyContent:n,marginBottom:"1rem"},children:(0,l.jsxs)("div",{style:{maxWidth:"70%",padding:"1rem",backgroundColor:t,color:s,borderRadius:"12px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[(0,l.jsx)("strong",{style:{fontSize:"0.9rem"},children:r?"\ud83d\udc68\u200d\ud83d\udcbc Admin":"\ud83d\udc64 "+(e.userEmail?e.userEmail.split("@")[0]:"Utilisateur")}),r&&(0,l.jsx)("span",{style:{fontSize:"0.7rem",padding:"0.2rem 0.5rem",backgroundColor:"rgba(255,255,255,0.3)",borderRadius:"8px"},children:"ADMIN"})]}),(0,l.jsx)("p",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",lineHeight:"1.5"},children:e.texte}),(0,l.jsx)("small",{style:{fontSize:"0.8rem",opacity:.8},children:a})]})})}function m(){const[e,r]=(0,t.useState)(""),[i,s]=(0,t.useState)([]),[n,m]=(0,t.useState)(!0),[g,u]=(0,t.useState)(!1),{user:x,loading:p}=(0,a.A)(),f="pro.alexis.costa@gmail.com"===x?.email;if(p)return(0,l.jsx)("div",{style:{textAlign:"center",padding:"4rem"},children:(0,l.jsx)("p",{style:{color:"#666",fontSize:"1.2rem"},children:"Chargement..."})});if(!x)return(0,l.jsx)("div",{style:{textAlign:"center",padding:"4rem"},children:(0,l.jsx)("p",{style:{color:"#666",fontSize:"1.2rem"},children:"Vous devez \xeatre connect\xe9"})});(0,t.useEffect)(()=>{if(x)try{const e=(0,o.P)((0,o.rJ)(d.db,"commentaires"),(0,o.My)("date","asc")),r=(0,o.aQ)(e,e=>{const r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),s(r),m(!1)},e=>{console.error("Erreur chargement messages:",e),m(!1)});return()=>r()}catch(e){console.error("Erreur initialisation:",e),m(!1)}},[x]);return(0,l.jsxs)("div",{style:{maxWidth:"900px",margin:"2rem auto",padding:"0 2rem"},children:[(0,l.jsxs)("div",{style:{background:"linear-gradient(135deg, #ffecd2 0%, #ffcbb3 25%, #ffb6b9 50%, #ffc9cb 75%, #ffd89b 100%)",padding:"2rem",borderRadius:"16px",marginBottom:"2rem",textAlign:"center"},children:[(0,l.jsx)("h1",{style:{color:"#3d3d3d",marginBottom:"1rem"},children:"\ud83d\udcac Messagerie"}),(0,l.jsx)("p",{style:{fontSize:"1.1rem",color:"#4a4a4a"},children:f?"Espace admin - R\xe9pondez aux utilisateurs":"Communiquez avec l'administrateur"})]}),(0,l.jsx)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"16px",boxShadow:"0 4px 12px rgba(255, 182, 185, 0.15)",marginBottom:"2rem",minHeight:"400px",maxHeight:"600px",overflowY:"auto"},children:n?(0,l.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,l.jsx)("p",{style:{color:"#666"},children:"Chargement des messages..."})}):0===i.length?(0,l.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,l.jsx)("p",{style:{color:"#666",fontSize:"1.1rem"},children:"Aucun message pour le moment. Soyez le premier \xe0 \xe9crire !"})}):i.map(e=>(0,l.jsx)(c,{message:e,isAdmin:e.isAdmin,isOwnMessage:e.userId===x.uid},e.id))}),(0,l.jsxs)("div",{style:{backgroundColor:"white",padding:"2rem",borderRadius:"16px",boxShadow:"0 4px 12px rgba(255, 182, 185, 0.15)"},children:[(0,l.jsx)("h2",{style:{color:"#ff9a9e",marginBottom:"1.5rem",fontSize:"1.3rem"},children:f?"\ud83d\udcac R\xe9pondre":"\u2709\ufe0f Nouveau message"}),(0,l.jsxs)("form",{onSubmit:async i=>{if(i.preventDefault(),e.trim()&&!g){u(!0);try{await(0,o.gS)((0,o.rJ)(d.db,"commentaires"),{texte:e,userEmail:x.email,userId:x.uid,isAdmin:f,date:(0,o.O5)()}),r("")}catch(t){console.error("Erreur envoi message:",t),alert("Erreur lors de l'envoi du message. V\xe9rifiez les r\xe8gles Firebase.")}finally{u(!1)}}},children:[(0,l.jsx)("textarea",{value:e,onChange:e=>r(e.target.value),placeholder:f?"\xc9crivez votre r\xe9ponse...":"\xc9crivez votre message \xe0 l'admin...",rows:4,style:{width:"100%",padding:"1rem",borderRadius:"8px",border:"2px solid #ffe5e6",fontSize:"1rem",resize:"vertical",fontFamily:"inherit",boxSizing:"border-box"}}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1rem"},children:[(0,l.jsxs)("small",{style:{color:"#666"},children:["Connect\xe9 en tant que : ",(0,l.jsx)("strong",{children:x.email}),f&&(0,l.jsx)("span",{style:{color:"#ff9a9e"},children:" (Admin)"})]}),(0,l.jsx)("button",{type:"submit",disabled:g||!e.trim(),style:{padding:"0.75rem 2rem",backgroundColor:g?"#ccc":f?"#ff9a9e":"#6bcf7f",color:"white",border:"none",borderRadius:"20px",fontWeight:"600",cursor:g?"not-allowed":"pointer",fontSize:"1rem"},onMouseOver:r=>{!g&&e.trim()&&(r.target.style.transform="scale(1.05)")},onMouseOut:e=>{e.target.style.transform="scale(1)"},children:g?"Envoi...":"\ud83d\udce4 Envoyer"})]})]})]}),(0,l.jsx)("div",{style:{marginTop:"2rem",padding:"1rem",backgroundColor:"#fff9f0",borderRadius:"12px",textAlign:"center"},children:(0,l.jsxs)("p",{style:{fontSize:"0.9rem",color:"#666",margin:0},children:["\u2728 ",(0,l.jsx)("strong",{children:"Messages en temps r\xe9el"})," - Les nouveaux messages apparaissent automatiquement"]})})]})}function g(){return(0,l.jsx)(n.A,{title:"Messagerie",description:"Zone de messagerie",children:(0,l.jsx)(s.A,{title:"Messagerie",description:"Zone de messagerie",children:(0,l.jsx)(m,{})})})}}}]);